<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <title>Upload Flipbook với Heyzine</title>
    <style>
      body {
        font-family: sans-serif;
        padding: 20px;
      }
      iframe {
        width: 100%;
        height: 600px;
        margin-top: 20px;
        border: none;
      }
    </style>
  </head>
  <body>
    <h2>Tạo Flipbook từ PDF</h2>

    <input type="file" id="pdfFile" accept="application/pdf" />
    <button onclick="uploadFlipbook()">Tải lên</button>

    <div id="loading" style="display: none">Đang tải lên...</div>
    <div id="result"></div>

    <script>
      async function uploadFlipbook() {
        const fileInput = document.getElementById("pdfFile");
        const file = fileInput.files[0];

        if (!file) {
          alert("Vui lòng chọn một file PDF.");
          return;
        }

        document.getElementById("loading").style.display = "block";

        const formData = new FormData();
        formData.append("file", file);

        try {
          const response = await fetch("https://api.heyzine.com/v1/flipbooks", {
            method: "POST",
            headers: {
              Authorization:
                "5ed8e59caeca7140e2ef91106805922918d89451.f019775a16596720",
            },
            body: formData,
          });

          const data = await response.json();

          document.getElementById("loading").style.display = "none";

          if (data.url) {
            document.getElementById("result").innerHTML = `
            <p><strong>Link flipbook:</strong> <a href="${data.url}" target="_blank">${data.url}</a></p>
            <iframe src="${data.url}"></iframe>
          `;
          } else {
            document.getElementById("result").innerText =
              "Lỗi: Không nhận được URL.";
            console.error(data);
          }
        } catch (error) {
          document.getElementById("loading").style.display = "none";
          alert("Đã xảy ra lỗi khi upload.");
          console.error(error);
        }
      }
    </script>
  </body>
</html>
